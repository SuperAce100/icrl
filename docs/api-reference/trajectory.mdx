---
title: Trajectory
description: "Complete episode trajectory data model"
---

## Overview

A `Trajectory` represents a complete episode, containing the goal, plan, all steps taken, and the final outcome.

```python
from icicl import Trajectory
```

## Definition

```python
class Trajectory(BaseModel):
    id: str = Field(default_factory=lambda: str(uuid.uuid4()))
    goal: str
    plan: str
    steps: list[Step]
    success: bool
    metadata: dict[str, Any] = Field(default_factory=dict)
```

## Fields

<ParamField path="id" type="str" default="auto-generated UUID">
  Unique identifier for the trajectory. Auto-generated using UUID4 if not provided.
</ParamField>

<ParamField path="goal" type="str" required>
  The goal description for this episode.
</ParamField>

<ParamField path="plan" type="str" required>
  The plan generated at the start of the episode.
</ParamField>

<ParamField path="steps" type="list[Step]" required>
  List of steps taken during the episode. See [Step](/api-reference/step).
</ParamField>

<ParamField path="success" type="bool" required>
  Whether the goal was achieved.
</ParamField>

<ParamField path="metadata" type="dict[str, Any]" default="{}">
  Optional metadata for custom tracking.
</ParamField>

## Methods

### to_example_string

```python
def to_example_string(self) -> str
```

Convert the trajectory to a formatted string suitable for in-context examples.

<ResponseField name="return" type="str">
  Formatted string representation of the trajectory.
</ResponseField>

```python
trajectory = Trajectory(
    goal="Find the config file",
    plan="1. Navigate to /etc\n2. List files\n3. Read config",
    steps=[
        Step(observation="Current dir: /", reasoning="Go to /etc", action="cd /etc"),
        Step(observation="Changed to /etc", reasoning="List files", action="ls"),
    ],
    success=True,
)

example = trajectory.to_example_string()
print(example)
```

Output:
```
Goal: Find the config file
Plan: 1. Navigate to /etc
2. List files
3. Read config
Steps:
  Step 1:
    Observation: Current dir: /
    Reasoning: Go to /etc
    Action: cd /etc
  Step 2:
    Observation: Changed to /etc
    Reasoning: List files
    Action: ls
Success: True
```

## Creating Trajectories

### Minimal

```python
trajectory = Trajectory(
    goal="Complete the task",
    plan="1. Do something",
    steps=[],
    success=False,
)
```

### With Steps

```python
from icicl import Trajectory, Step

trajectory = Trajectory(
    goal="Navigate and read file",
    plan="1. Go to directory\n2. Read file",
    steps=[
        Step(
            observation="Current directory: /",
            reasoning="Need to navigate first",
            action="cd /home",
        ),
        Step(
            observation="Changed to /home",
            reasoning="Now read the file",
            action="cat notes.txt",
        ),
    ],
    success=True,
)
```

### With Custom ID

```python
trajectory = Trajectory(
    id="my-custom-id-123",
    goal="Custom task",
    plan="Do it",
    steps=[],
    success=True,
)
```

### With Metadata

```python
trajectory = Trajectory(
    goal="Task with metadata",
    plan="Execute",
    steps=[],
    success=True,
    metadata={
        "duration_seconds": 45.2,
        "model": "gpt-4o-mini",
        "temperature": 0.7,
        "user_id": "user-123",
    },
)
```

## Serialization

Trajectories are Pydantic models and support full serialization:

### To Dictionary

```python
data = trajectory.model_dump()
# {
#     "id": "550e8400-...",
#     "goal": "Find the config file",
#     "plan": "1. Navigate...",
#     "steps": [...],
#     "success": True,
#     "metadata": {}
# }
```

### To JSON

```python
json_str = trajectory.model_dump_json()
```

### From Dictionary

```python
data = {...}
trajectory = Trajectory.model_validate(data)
```

### From JSON

```python
trajectory = Trajectory.model_validate_json(json_str)
```

## Usage in Agent

Trajectories are returned from training and inference:

```python
# Training returns a trajectory
trajectory = await agent.train(env, goal="Complete task")

# Access trajectory data
print(f"Goal: {trajectory.goal}")
print(f"Success: {trajectory.success}")
print(f"Steps taken: {len(trajectory.steps)}")
print(f"Plan: {trajectory.plan}")

# Iterate over steps
for i, step in enumerate(trajectory.steps, 1):
    print(f"Step {i}: {step.action}")
```

## Storing and Retrieving

```python
# Trajectories are automatically stored after successful training
trajectory = await agent.train(env, "Task")

if trajectory.success:
    # Now searchable in database
    similar = agent.database.search("Task", k=3)
    
# Get specific trajectory
traj = agent.database.get(trajectory.id)

# Get all trajectories
all_trajs = agent.database.get_all()
```

## Comparison

```python
# Trajectories can be compared by ID
traj1 = Trajectory(goal="A", plan="P", steps=[], success=True)
traj2 = Trajectory(goal="A", plan="P", steps=[], success=True)

# Different IDs (auto-generated)
print(traj1.id == traj2.id)  # False

# Same content comparison
print(traj1.goal == traj2.goal)  # True
```
